(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{5757:function(e,t,s){Promise.resolve().then(s.bind(s,4913))},4913:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ProjectDetailPage}});var a,r,i,n,l=s(7437),c=s(2265),d=s(4033),o=s(3753);function TrashIcon({title:e,titleId:t,...s},a){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?c.createElement("title",{id:t},e):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}let m=c.forwardRef(TrashIcon);var u=s(5838),x=s(6806),h=s(345);function Tabs(e){var t;let{tabs:s,defaultTab:a,onChange:r,className:i,tabListClassName:n,tabClassName:d,activeTabClassName:o,disabledTabClassName:m}=e,[u,x]=(0,c.useState)(a||(null===(t=s[0])||void 0===t?void 0:t.id)||""),p=(0,c.useRef)(null),[j,v]=(0,c.useState)(!1),[g,f]=(0,c.useState)({left:"0px",width:"0px"});(0,c.useEffect)(()=>{a&&a!==u&&x(a)},[a,u]),(0,c.useEffect)(()=>{var e,t;let s=null===(e=p.current)||void 0===e?void 0:e.querySelectorAll('[role="tab"]'),a=null===(t=p.current)||void 0===t?void 0:t.querySelector('[data-tab-id="'.concat(u,'"]'));if(a instanceof HTMLElement&&(null==s?void 0:s.length)){let{offsetLeft:e,offsetWidth:t}=a;f({left:"".concat(e,"px"),width:"".concat(t,"px")}),v(!0)}},[u,s]);let handleTabClick=e=>{e!==u&&(x(e),null==r||r(e))},handleKeyDown=(e,t)=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),handleTabClick(t))};return(0,l.jsx)("div",{className:(0,h.cn)("w-full",i),children:(0,l.jsxs)("div",{ref:p,className:(0,h.cn)("relative flex border-b border-neutral-200",n),role:"tablist","aria-orientation":"horizontal",children:[s.map(e=>(0,l.jsx)("div",{"data-tab-id":e.id,role:"tab",tabIndex:e.disabled?-1:u===e.id?0:-1,"aria-selected":u===e.id,"aria-disabled":e.disabled,onClick:()=>!e.disabled&&handleTabClick(e.id),onKeyDown:t=>!e.disabled&&handleKeyDown(t,e.id),className:(0,h.cn)("px-4 py-2 font-medium cursor-pointer transition-colors","focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2",u===e.id?(0,h.cn)("text-primary",o):"text-neutral-500 hover:text-neutral-800",e.disabled&&(0,h.cn)("cursor-not-allowed opacity-50",m),d),children:e.label},e.id)),(0,l.jsx)("div",{className:(0,h.cn)("absolute bottom-0 h-0.5 bg-primary transition-all duration-300 ease-in-out",!j&&"opacity-0"),style:g,"aria-hidden":"true"})]})})}function TabPanel(e){let{id:t,activeTab:s,children:a,className:r}=e,i=t===s;return(0,l.jsx)("div",{role:"tabpanel",id:"panel-".concat(t),"aria-labelledby":"tab-".concat(t),hidden:!i,className:(0,h.cn)(i?"block":"hidden",r),children:a})}var p=s(1018),j=s(3192),v=s(2125);function ProjectInfo(e){var t,s,a,r,i,n;let{project:c,isLoading:o=!1}=e,m=(0,d.useRouter)();return o?(0,l.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-24"})]})}),(0,l.jsxs)(p.aY,{className:"space-y-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(6)].map((e,t)=>(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-5 bg-neutral-200 rounded w-3/4"})]},t))}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/4"}),(0,l.jsx)("div",{className:"h-20 bg-neutral-200 rounded w-full"})]})]})]}):(0,l.jsxs)(p.Zb,{children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(p.ll,{children:"Informations projet"}),(0,l.jsxs)(x.z,{onClick:()=>m.push("/projects/".concat(c.id,"/edit")),size:"sm",variant:"outline",className:"flex items-center gap-1",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4"}),"Modifier"]})]})}),(0,l.jsxs)(p.aY,{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"\xc9tat"}),(0,l.jsx)(j.C,{variant:(e=>{if(!e)return"gray";switch(e.toLowerCase()){case"en cours":return"blue";case"termin\xe9":return"green";case"suspendu":return"yellow";case"annul\xe9":return"red";default:return"gray"}})(null===(t=c.status)||void 0===t?void 0:t.name),children:(null===(s=c.status)||void 0===s?void 0:s.name)||"-"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Progression"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-32 h-2 bg-neutral-200 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"".concat(65,"%")}})}),(0,l.jsx)("span",{className:"text-sm font-medium",children:(0,h.T3)(65)})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Type"}),(0,l.jsx)("p",{className:"font-medium",children:(null===(a=c.type)||void 0===a?void 0:a.name)||"-"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Priorit\xe9"}),(0,l.jsx)("p",{className:"font-medium",children:(null===(r=c.priority)||void 0===r?void 0:r.name)||"-"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Direction"}),(0,l.jsx)("p",{className:"font-medium",children:(null===(i=c.direction)||void 0===i?void 0:i.name)||"-"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"\xc9quipe"}),(0,l.jsx)("p",{className:"font-medium",children:(null===(n=c.team)||void 0===n?void 0:n.name)||"-"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Date de d\xe9but"}),(0,l.jsx)("p",{className:"font-medium",children:(0,h.p6)(c.startDate)||"-"})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Date de fin pr\xe9vue"}),(0,l.jsx)("p",{className:"font-medium",children:(0,h.p6)(c.endDate)||"-"})]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500",children:"Description"}),(0,l.jsx)("p",{className:"text-sm",children:c.description||"Aucune description disponible"})]})]})]})}var g=s(3510);function UserPlusIcon({title:e,titleId:t,...s},a){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?c.createElement("title",{id:t},e):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}let f=c.forwardRef(UserPlusIcon);var N=s(5255);function ProjectTeam(e){let{project:t,isLoading:s=!1}=e,[a,r]=(0,c.useState)(!1),i=t.team,n=(null==i?void 0:i.members)||[];return s?(0,l.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-24"})]})}),(0,l.jsxs)(p.aY,{children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-full mb-4"}),(0,l.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,l.jsx)("div",{className:"h-12 bg-neutral-200 rounded w-full"},t))})]})]}):(0,l.jsxs)(p.Zb,{children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(p.ll,{children:"\xc9quipe"}),(0,l.jsxs)(x.z,{onClick:()=>r(!a),size:"sm",variant:"outline",className:"flex items-center gap-1",children:[(0,l.jsx)(f,{className:"h-4 w-4"}),"Ajouter un membre"]})]})}),(0,l.jsxs)(p.aY,{children:[i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{className:"text-sm mb-4",children:["\xc9quipe: ",(0,l.jsx)("span",{className:"font-medium",children:i.name})]}),n.length>0?(0,l.jsxs)(g.iA,{children:[(0,l.jsx)(g.xD,{children:(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.ss,{children:"Membre"}),(0,l.jsx)(g.ss,{children:"R\xf4le"}),(0,l.jsx)(g.ss,{children:"Direction"}),(0,l.jsx)(g.ss,{children:"Contact"})]})}),(0,l.jsx)(g.RM,{children:n.map(e=>{var t,s,a,r,i,n,c,d,o,m;return(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.pj,{className:"py-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary/10 text-primary flex items-center justify-center font-medium text-sm",children:(0,h.Qm)(null===(t=e.user)||void 0===t?void 0:t.firstName,null===(s=e.user)||void 0===s?void 0:s.lastName)}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-medium",children:[null===(a=e.user)||void 0===a?void 0:a.firstName," ",null===(r=e.user)||void 0===r?void 0:r.lastName]}),(0,l.jsx)("p",{className:"text-xs text-neutral-500",children:(null===(i=e.user)||void 0===i?void 0:i.function)||""})]})]})}),(0,l.jsx)(g.pj,{className:"py-2",children:(null===(n=e.role)||void 0===n?void 0:n.name)||"-"}),(0,l.jsx)(g.pj,{className:"py-2",children:(null===(d=e.user)||void 0===d?void 0:null===(c=d.direction)||void 0===c?void 0:c.name)||"-"}),(0,l.jsxs)(g.pj,{className:"py-2",children:[(0,l.jsx)("p",{children:null===(o=e.user)||void 0===o?void 0:o.email}),(0,l.jsx)("p",{className:"text-xs text-neutral-500",children:(null===(m=e.user)||void 0===m?void 0:m.phone)||"-"})]})]},"".concat(e.teamId,"-").concat(e.userId))})})]}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("p",{className:"text-neutral-500 mb-2",children:"Aucun membre dans l'\xe9quipe"}),(0,l.jsxs)(x.z,{variant:"outline",size:"sm",className:"flex items-center gap-1 mx-auto",onClick:()=>r(!0),children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"Ajouter des membres"]})]})]}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("p",{className:"text-neutral-500 mb-2",children:"Aucune \xe9quipe associ\xe9e au projet"}),(0,l.jsx)(x.z,{variant:"outline",size:"sm",className:"mx-auto",children:"Cr\xe9er une \xe9quipe"})]}),a&&(0,l.jsxs)("div",{className:"mt-4 p-4 border rounded-md",children:[(0,l.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Ajouter un membre \xe0 l'\xe9quipe"}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,l.jsx)(x.z,{variant:"outline",size:"sm",onClick:()=>r(!1),children:"Annuler"}),(0,l.jsx)(x.z,{size:"sm",children:"Ajouter"})]})]})]})]})}function ProjectPlanning(e){let{project:t,isLoading:s=!1}=e,a=[{id:1,projectId:t.id,phaseId:1,phase:{id:1,name:"Initiation",percentage:10}},{id:2,projectId:t.id,phaseId:2,phase:{id:2,name:"Planification",percentage:20}},{id:3,projectId:t.id,phaseId:3,phase:{id:3,name:"Ex\xe9cution",percentage:50}},{id:4,projectId:t.id,phaseId:4,phase:{id:4,name:"Cl\xf4ture",percentage:20}}],r=[{phaseId:1,progress:100},{phaseId:2,progress:80},{phaseId:3,progress:30},{phaseId:4,progress:0}],i=(()=>{let e=0,t=0;for(let s of a)if(s.phase){let a=s.phase.percentage,i=r.find(e=>e.phaseId===s.phaseId);i&&(e+=i.progress*a/100,t+=a)}return t>0?e/t*100:0})();return s?(0,l.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-24"})]})}),(0,l.jsx)(p.aY,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-3/4"}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,l.jsx)("div",{className:"h-16 bg-neutral-200 rounded w-full"},t))]})})]}):(0,l.jsxs)(p.Zb,{children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(p.ll,{children:"Planning"}),(0,l.jsxs)(x.z,{size:"sm",variant:"outline",className:"flex items-center gap-1",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"Ajouter une phase"]})]})}),(0,l.jsxs)(p.aY,{children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Progression globale"}),(0,l.jsx)("p",{className:"text-sm font-medium",children:(0,h.T3)(i)})]}),(0,l.jsx)("div",{className:"w-full h-2 bg-neutral-200 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"".concat(i,"%")}})})]}),(0,l.jsx)("div",{className:"space-y-4",children:a.length>0?a.map(e=>{var t,s;let a=r.find(t=>t.phaseId===e.phaseId),i=a?a.progress:0;return(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium",children:null===(t=e.phase)||void 0===t?void 0:t.name}),(0,l.jsxs)("p",{className:"text-xs text-neutral-500",children:["Poids: ",null===(s=e.phase)||void 0===s?void 0:s.percentage,"%"]})]}),(0,l.jsx)("div",{className:"text-right",children:(0,l.jsx)("p",{className:"font-medium",children:(0,h.T3)(i)})})]}),(0,l.jsx)("div",{className:"w-full h-1.5 bg-neutral-200 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"".concat(i,"%")}})})]},e.id)}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("p",{className:"text-neutral-500 mb-2",children:"Aucune phase de planning d\xe9finie"}),(0,l.jsxs)(x.z,{variant:"outline",size:"sm",className:"flex items-center gap-1 mx-auto",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"Ajouter une phase"]})]})})]})]})}var b=s(9828);function ProjectActions(e){let{project:t,isLoading:s=!1}=e,[a,r]=(0,c.useState)(null),i=[{id:1,planningId:1,title:"D\xe9finir les exigences fonctionnelles",statusId:2,userId:1,startDate:"2023-03-01",endDate:"2023-03-15",progress:100,status:{id:2,name:"Termin\xe9"},user:{id:1,firstName:"Jean",lastName:"Dupont",email:"jean.dupont@example.com",directionId:1}},{id:2,planningId:1,title:"Concevoir l'architecture technique",statusId:2,userId:2,startDate:"2023-03-10",endDate:"2023-03-25",progress:100,status:{id:2,name:"Termin\xe9"},user:{id:2,firstName:"Marie",lastName:"Lambert",email:"marie.lambert@example.com",directionId:2}},{id:3,planningId:2,title:"D\xe9velopper le module d'authentification",statusId:1,userId:3,startDate:"2023-03-20",endDate:"2023-04-10",progress:75,status:{id:1,name:"En cours"},user:{id:3,firstName:"Paul",lastName:"Martin",email:"paul.martin@example.com",directionId:1}},{id:4,planningId:2,title:"Tester les fonctionnalit\xe9s de base",statusId:3,userId:4,startDate:"2023-04-01",endDate:"2023-04-15",progress:0,status:{id:3,name:"A faire"},user:{id:4,firstName:"Sophie",lastName:"Durand",email:"sophie.durand@example.com",directionId:3}}],n=a?i.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.name)===a}):i,d=[...Array.from(new Set(i.map(e=>{var t;return null===(t=e.status)||void 0===t?void 0:t.name})))].filter(Boolean),getStatusBadgeVariant=e=>{if(!e)return"gray";switch(e.toLowerCase()){case"en cours":return"blue";case"termin\xe9":return"green";case"a faire":default:return"gray";case"en retard":return"red";case"suspendu":return"yellow"}};return s?(0,l.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-24"})]})}),(0,l.jsxs)(p.aY,{children:[(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-full mb-4"}),(0,l.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,l.jsx)("div",{className:"h-24 bg-neutral-200 rounded w-full"},t))})]})]}):(0,l.jsxs)(p.Zb,{children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(p.ll,{children:"Actions"}),(0,l.jsxs)(x.z,{size:"sm",variant:"outline",className:"flex items-center gap-1",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"Nouvelle action"]})]})}),(0,l.jsxs)(p.aY,{children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,l.jsx)(x.z,{size:"sm",variant:null===a?"default":"ghost",onClick:()=>r(null),children:"Toutes"}),d.map(e=>(0,l.jsx)(x.z,{size:"sm",variant:a===e?"default":"ghost",onClick:()=>r(e),children:e},e)),(0,l.jsxs)(x.z,{size:"sm",variant:"ghost",className:"ml-auto flex items-center gap-1",children:[(0,l.jsx)(b.Z,{className:"h-3.5 w-3.5"}),"Plus de filtres"]})]}),(0,l.jsx)("div",{className:"space-y-4",children:n.length>0?n.map(e=>{var t,s,a,r,i,n;return(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium",children:e.title}),(0,l.jsxs)("div",{className:"flex items-center gap-3 text-sm text-neutral-500 mt-1",children:[(0,l.jsxs)("span",{children:[(0,h.p6)(e.startDate,"dd/MM/yy")," -"," ",(0,h.p6)(e.endDate,"dd/MM/yy")]}),(0,l.jsx)(j.C,{variant:getStatusBadgeVariant(null===(t=e.status)||void 0===t?void 0:t.name),children:(null===(s=e.status)||void 0===s?void 0:s.name)||"-"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,l.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary/10 text-primary flex items-center justify-center font-medium text-xs",children:(0,h.Qm)(null===(a=e.user)||void 0===a?void 0:a.firstName,null===(r=e.user)||void 0===r?void 0:r.lastName)}),(0,l.jsxs)("span",{className:"text-neutral-500",children:[null===(i=e.user)||void 0===i?void 0:i.firstName," ",null===(n=e.user)||void 0===n?void 0:n.lastName]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-full h-1.5 bg-neutral-200 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"".concat(e.progress,"%")}})}),(0,l.jsx)("span",{className:"text-xs font-medium min-w-[40px] text-right",children:(0,h.T3)(e.progress)})]})]},e.id)}):(0,l.jsx)("div",{className:"text-center py-8",children:a?(0,l.jsxs)("p",{className:"text-neutral-500",children:['Aucune action avec le statut "',a,'"']}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"text-neutral-500 mb-2",children:"Aucune action d\xe9finie"}),(0,l.jsxs)(x.z,{variant:"outline",size:"sm",className:"flex items-center gap-1 mx-auto",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"Ajouter une action"]})]})})})]})]})}function DocumentIcon({title:e,titleId:t,...s},a){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?c.createElement("title",{id:t},e):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}let w=c.forwardRef(DocumentIcon);function ArrowDownTrayIcon({title:e,titleId:t,...s},a){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?c.createElement("title",{id:t},e):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}let y=c.forwardRef(ArrowDownTrayIcon);function ProjectDocuments(e){let{project:t,isLoading:s=!1}=e,[a,r]=(0,c.useState)(""),i=[{id:1,projectId:t.id,title:"Cahier des charges",version:"1.2",statusId:2,path:"/files/cahier-des-charges-v1.2.pdf",uploadedById:1,uploadDate:"2023-02-15",status:{id:2,name:"Valid\xe9"},uploadedBy:{id:1,firstName:"Jean",lastName:"Dupont",email:"jean.dupont@example.com",directionId:1}},{id:2,projectId:t.id,title:"Sp\xe9cifications techniques",version:"2.0",statusId:2,path:"/files/specs-tech-v2.0.docx",uploadedById:2,uploadDate:"2023-03-10",status:{id:2,name:"Valid\xe9"},uploadedBy:{id:2,firstName:"Marie",lastName:"Lambert",email:"marie.lambert@example.com",directionId:2}},{id:3,projectId:t.id,title:"Planning de d\xe9veloppement",version:"1.0",statusId:1,path:"/files/planning-dev-v1.0.xlsx",uploadedById:3,uploadDate:"2023-03-20",status:{id:1,name:"En revue"},uploadedBy:{id:3,firstName:"Paul",lastName:"Martin",email:"paul.martin@example.com",directionId:1}}],n=i.filter(e=>{var t;return e.title.toLowerCase().includes(a.toLowerCase())||e.version.toLowerCase().includes(a.toLowerCase())||(null===(t=e.status)||void 0===t?void 0:t.name.toLowerCase().includes(a.toLowerCase()))}),getStatusBadgeVariant=e=>{if(!e)return"gray";switch(e.toLowerCase()){case"valid\xe9":return"green";case"en revue":return"blue";case"brouillon":default:return"gray";case"rejet\xe9":return"red";case"obsol\xe8te":return"yellow"}},getDocumentTypeIcon=e=>{var t;if(!e)return(0,l.jsx)(w,{className:"h-6 w-6 text-neutral-400"});let s=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();switch(s){case"pdf":return(0,l.jsx)(w,{className:"h-6 w-6 text-red-500"});case"doc":case"docx":return(0,l.jsx)(w,{className:"h-6 w-6 text-blue-500"});case"xls":case"xlsx":return(0,l.jsx)(w,{className:"h-6 w-6 text-green-500"});case"ppt":case"pptx":return(0,l.jsx)(w,{className:"h-6 w-6 text-orange-500"});default:return(0,l.jsx)(w,{className:"h-6 w-6 text-neutral-400"})}};return s?(0,l.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-24"})]})}),(0,l.jsxs)(p.aY,{children:[(0,l.jsx)("div",{className:"h-10 bg-neutral-200 rounded w-full mb-4"}),(0,l.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((e,t)=>(0,l.jsx)("div",{className:"h-14 bg-neutral-200 rounded w-full"},t))})]})]}):(0,l.jsxs)(p.Zb,{children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(p.ll,{children:"Documents"}),(0,l.jsxs)(x.z,{size:"sm",variant:"outline",className:"flex items-center gap-1",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"T\xe9l\xe9verser un document"]})]})}),(0,l.jsxs)(p.aY,{children:[(0,l.jsx)("div",{className:"relative mb-4",children:(0,l.jsx)("input",{type:"text",placeholder:"Rechercher un document...",className:"w-full rounded-md border border-neutral-300 px-4 py-2 text-sm",value:a,onChange:e=>r(e.target.value)})}),n.length>0?(0,l.jsxs)(g.iA,{children:[(0,l.jsx)(g.xD,{children:(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.ss,{className:"w-12"}),(0,l.jsx)(g.ss,{children:"Titre"}),(0,l.jsx)(g.ss,{children:"Version"}),(0,l.jsx)(g.ss,{children:"Statut"}),(0,l.jsx)(g.ss,{children:"T\xe9l\xe9vers\xe9 par"}),(0,l.jsx)(g.ss,{children:"Date"}),(0,l.jsx)(g.ss,{className:"w-12"})]})}),(0,l.jsx)(g.RM,{children:n.map(e=>{var t,s,a,r;return(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.pj,{className:"py-2",children:getDocumentTypeIcon(e.path)}),(0,l.jsx)(g.pj,{className:"font-medium py-2",children:e.title}),(0,l.jsx)(g.pj,{className:"py-2",children:e.version}),(0,l.jsx)(g.pj,{className:"py-2",children:(0,l.jsx)(j.C,{variant:getStatusBadgeVariant(null===(t=e.status)||void 0===t?void 0:t.name),children:(null===(s=e.status)||void 0===s?void 0:s.name)||"-"})}),(0,l.jsxs)(g.pj,{className:"py-2",children:[null===(a=e.uploadedBy)||void 0===a?void 0:a.firstName," ",null===(r=e.uploadedBy)||void 0===r?void 0:r.lastName]}),(0,l.jsx)(g.pj,{className:"py-2 text-neutral-500",children:(0,h.p6)(e.uploadDate,"dd MMM yyyy")}),(0,l.jsx)(g.pj,{className:"py-2",children:(0,l.jsx)(x.z,{size:"icon",variant:"ghost",className:"h-8 w-8",children:(0,l.jsx)(y,{className:"h-4 w-4"})})})]},e.id)})})]}):(0,l.jsx)("div",{className:"text-center py-12",children:a?(0,l.jsxs)("p",{className:"text-neutral-500",children:['Aucun document ne correspond \xe0 votre recherche "',a,'"']}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"text-neutral-500 mb-3",children:"Aucun document associ\xe9 au projet"}),(0,l.jsxs)(x.z,{variant:"outline",size:"sm",className:"flex items-center gap-1 mx-auto",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),"T\xe9l\xe9verser un document"]})]})})]})]})}function ProjectBudget(e){let{project:t,isLoading:s=!1}=e,a={id:1,projectId:t.id,initialBudget:15e4,consumedBudget:87500},r=a?a.consumedBudget/a.initialBudget*100:0,i=a?a.initialBudget-a.consumedBudget:0,{status:n,color:c}=r>90?{status:"Critique",color:"text-red-500"}:r>75?{status:"Attention",color:"text-yellow-500"}:{status:"Bon",color:"text-green-500"};return s?(0,l.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-24"})]})}),(0,l.jsx)(p.aY,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"h-20 bg-neutral-200 rounded w-full"}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((e,t)=>(0,l.jsx)("div",{className:"h-16 bg-neutral-200 rounded"},t))}),(0,l.jsx)("div",{className:"h-32 bg-neutral-200 rounded w-full"})]})})]}):(0,l.jsxs)(p.Zb,{children:[(0,l.jsx)(p.Ol,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(p.ll,{children:"Budget"}),(0,l.jsxs)(x.z,{size:"sm",variant:"outline",className:"flex items-center gap-1",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4"}),"Modifier"]})]})}),(0,l.jsx)(p.aY,{className:"space-y-6",children:a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Utilisation du budget"}),(0,l.jsx)("p",{className:"text-sm font-medium ".concat(c),children:(0,h.T3)(r)})]}),(0,l.jsx)("div",{className:"w-full h-2 bg-neutral-200 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full rounded-full ".concat(r>90?"bg-red-500":r>75?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(r,"%")}})}),(0,l.jsxs)("p",{className:"text-xs mt-1 ".concat(c),children:["Statut: ",n]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"p-4 bg-primary/5 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500 mb-1",children:"Budget initial"}),(0,l.jsx)("p",{className:"text-lg font-semibold",children:(0,h.xG)(a.initialBudget)})]}),(0,l.jsxs)("div",{className:"p-4 bg-primary/5 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500 mb-1",children:"Consomm\xe9"}),(0,l.jsx)("p",{className:"text-lg font-semibold",children:(0,h.xG)(a.consumedBudget)})]}),(0,l.jsxs)("div",{className:"p-4 bg-primary/5 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-neutral-500 mb-1",children:"Restant"}),(0,l.jsx)("p",{className:"text-lg font-semibold",children:(0,h.xG)(i)})]})]}),(0,l.jsx)("div",{className:"aspect-[2/1] bg-neutral-50 rounded-lg border flex items-center justify-center",children:(0,l.jsx)("p",{className:"text-neutral-400",children:"Graphique d'\xe9volution du budget"})})]}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("p",{className:"text-neutral-500 mb-3",children:"Aucun budget d\xe9fini pour ce projet"}),(0,l.jsxs)(x.z,{variant:"outline",size:"sm",className:"flex items-center gap-1 mx-auto",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4"}),"D\xe9finir un budget"]})]})})]})}function DocumentArrowDownIcon({title:e,titleId:t,...s},a){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?c.createElement("title",{id:t},e):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}let I=c.forwardRef(DocumentArrowDownIcon);var T=s(4291),D=s(6454),C=s(9789);(a=i||(i={})).Critical="critical",a.Warning="warning",a.Good="good",a.Unknown="unknown",(r=n||(n={})).Number="number",r.Gauge="gauge",r.Chart="chart",r.Table="table";let S={[i.Critical]:"bg-error",[i.Warning]:"bg-warning",[i.Good]:"bg-success",[i.Unknown]:"bg-neutral-400"};function ProjectKpis(e){let{project:t,onKpiSelect:s}=e,[a,r]=(0,c.useState)([]),[n,d]=(0,c.useState)(!0),[o,m]=(0,c.useState)(null),[u,v]=(0,c.useState)(!1);(0,c.useEffect)(()=>{fetchKpis()},[t.id]);let fetchKpis=async()=>{try{d(!0),m(null);let e=await (0,C.OS)((0,C.wA)(t.id,t.name),()=>D.Hv.kpis.getProjectKpis(t.id));r(e)}catch(e){console.error("Error fetching KPIs:",e),m((0,h.e$)(e))}finally{d(!1)}},refreshKpis=async()=>{try{v(!0),m(null),await fetchKpis()}catch(e){console.error("Error refreshing KPIs:",e),m((0,h.e$)(e))}finally{v(!1)}},exportKpis=async e=>{try{let s=await D.Hv.kpis.exportKpiData(t.id,e),a=new Blob([s.data],{type:"csv"===e?"text/csv":"excel"===e?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"application/pdf"}),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.setAttribute("download","kpi-report-".concat(t.name.replace(/\s+/g,"-"),".").concat(e)),document.body.appendChild(i),i.click(),i.remove()}catch(e){console.error("Error exporting KPIs:",e),m((0,h.e$)(e))}},getKpiStatus=e=>e.criticalThresholdBreached?i.Critical:e.warningThresholdBreached?i.Warning:i.Good,renderKpiValue=e=>{let t=getKpiStatus(e);return(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(S[t])}),(0,l.jsxs)("span",{className:"font-medium text-lg",children:[e.value.toFixed(1),"COMPLETION_RATE"===e.metricCode||"BUDGET_UTILIZATION"===e.metricCode||"TASK_COMPLETION"===e.metricCode?"%":"","DEADLINE_PROXIMITY"===e.metricCode?" jours":""]})]})})};return(0,l.jsxs)(p.Zb,{children:[(0,l.jsxs)(p.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,l.jsx)(p.ll,{children:"Indicateurs cl\xe9s de performance (KPIs)"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(x.z,{variant:"outline",size:"sm",onClick:()=>exportKpis("excel"),className:"flex items-center gap-1",children:[(0,l.jsx)(I,{className:"h-4 w-4"}),"Excel"]}),(0,l.jsxs)(x.z,{variant:"outline",size:"sm",onClick:refreshKpis,disabled:u,className:"flex items-center gap-1",children:[(0,l.jsx)(T.Z,{className:"h-4 w-4 ".concat(u?"animate-spin":"")}),"Rafra\xeechir"]})]})]}),(0,l.jsx)(p.aY,{children:n?(0,l.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,l.jsx)("div",{className:"h-14 bg-neutral-200 rounded"},t))}):o?(0,l.jsxs)("div",{className:"text-error",children:["Erreur: ",o]}):0===a.length?(0,l.jsx)("div",{className:"text-center py-8 text-neutral-500",children:"Aucun KPI disponible pour ce projet"}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>(0,l.jsx)(p.Zb,{className:"border border-neutral-200 ".concat(s?"hover:border-primary cursor-pointer transition-colors":""),onClick:()=>s&&s(e),children:(0,l.jsx)(p.aY,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-neutral-500",children:e.metricName}),renderKpiValue(e),(0,l.jsxs)("div",{className:"text-xs text-neutral-400",children:["Mis \xe0 jour: ",(0,h.p6)(new Date(e.measurementDate))]})]})})},e.id))}),(0,l.jsxs)(g.iA,{children:[(0,l.jsx)(g.xD,{children:(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.ss,{children:"Indicateur"}),(0,l.jsx)(g.ss,{children:"Valeur"}),(0,l.jsx)(g.ss,{children:"\xc9tat"}),(0,l.jsx)(g.ss,{children:"Date de mesure"})]})}),(0,l.jsx)(g.RM,{children:a.map(e=>(0,l.jsxs)(g.SC,{className:s?"hover:bg-neutral-50 cursor-pointer":"",onClick:()=>s&&s(e),children:[(0,l.jsx)(g.pj,{className:"font-medium",children:e.metricName}),(0,l.jsxs)(g.pj,{children:[e.value.toFixed(1),"COMPLETION_RATE"===e.metricCode||"BUDGET_UTILIZATION"===e.metricCode||"TASK_COMPLETION"===e.metricCode?"%":"","DEADLINE_PROXIMITY"===e.metricCode?" jours":""]}),(0,l.jsx)(g.pj,{children:(0,l.jsx)(j.C,{variant:getKpiStatus(e)===i.Critical?"destructive":getKpiStatus(e)===i.Warning?"warning":"success",children:getKpiStatus(e)===i.Critical?"Critique":getKpiStatus(e)===i.Warning?"Attention":"Bon"})}),(0,l.jsx)(g.pj,{className:"text-neutral-500",children:(0,h.p6)(new Date(e.measurementDate))})]},e.id||"".concat(e.projectId,"-").concat(e.metricId)))})]})]})})]})}function XMarkIcon({title:e,titleId:t,...s},a){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?c.createElement("title",{id:t},e):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}let A=c.forwardRef(XMarkIcon);function KpiDetail(e){let{project:t,kpiValue:s,onClose:a}=e,[r,i]=(0,c.useState)([]),[n,d]=(0,c.useState)(!0),[o,m]=(0,c.useState)(null),[u,j]=(0,c.useState)(!1);(0,c.useEffect)(()=>{fetchKpiHistory()},[s.metricId]);let fetchKpiHistory=async()=>{try{d(!0),m(null);let e=await (0,C.OS)((0,C.zh)(t.id,s.metricId,t.name,s.metricName),()=>D.Hv.kpis.getProjectKpiHistory(t.id,s.metricId));i(e)}catch(e){console.error("Error fetching KPI history:",e),m((0,h.e$)(e))}finally{d(!1)}},refreshHistory=async()=>{try{j(!0),m(null),await fetchKpiHistory()}catch(e){console.error("Error refreshing KPI history:",e),m((0,h.e$)(e))}finally{j(!1)}};return(0,l.jsxs)(p.Zb,{className:"w-full",children:[(0,l.jsxs)(p.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,l.jsx)(p.ll,{children:s.metricName}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(x.z,{variant:"outline",size:"sm",onClick:refreshHistory,disabled:u,className:"flex items-center gap-1",children:[(0,l.jsx)(T.Z,{className:"h-4 w-4 ".concat(u?"animate-spin":"")}),"Rafra\xeechir"]}),(0,l.jsxs)(x.z,{variant:"ghost",size:"sm",onClick:a,className:"flex items-center gap-1",children:[(0,l.jsx)(A,{className:"h-4 w-4"}),"Fermer"]})]})]}),(0,l.jsxs)(p.aY,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-neutral-100 p-4 rounded",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-neutral-500",children:"Valeur actuelle"}),(0,l.jsxs)("div",{className:"font-semibold text-xl",children:[s.value.toFixed(1),"COMPLETION_RATE"===s.metricCode||"BUDGET_UTILIZATION"===s.metricCode||"TASK_COMPLETION"===s.metricCode?"%":"","DEADLINE_PROXIMITY"===s.metricCode?" jours":""]})]}),(0,l.jsxs)("div",{className:"bg-neutral-100 p-4 rounded",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-neutral-500",children:"Date de mesure"}),(0,l.jsx)("div",{className:"font-semibold",children:(0,h.o0)(new Date(s.measurementDate))})]}),(0,l.jsxs)("div",{className:"bg-neutral-100 p-4 rounded",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-neutral-500",children:"Statut"}),(0,l.jsx)("div",{className:"font-semibold",children:s.criticalThresholdBreached?"Critique":s.warningThresholdBreached?"Attention":"Bon"})]})]}),n?(0,l.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,l.jsx)("div",{className:"h-40 bg-neutral-200 rounded"}),(0,l.jsx)("div",{className:"h-40 bg-neutral-200 rounded"})]}):o?(0,l.jsxs)("div",{className:"text-error",children:["Erreur: ",o]}):0===r.length?(0,l.jsx)("div",{className:"text-center py-8 text-neutral-500",children:"Aucun historique disponible pour cet indicateur"}):(0,l.jsxs)(l.Fragment,{children:[(()=>{if(0===r.length)return null;let e=[...r].sort((e,t)=>new Date(e.measurementDate).getTime()-new Date(t.measurementDate).getTime()),t=e.map(e=>e.value),a=Math.min(...t),i=Math.max(...t),n=i-a,c=e.map((t,s)=>{let r="".concat(s/(e.length-1)*100,"%"),i=0===n?.5:(t.value-a)/n;return{x:r,y:200-(120*i+40),value:t.value,date:t.measurementDate}}),d="";return c.forEach((e,t)=>{0===t?d+="M ".concat(e.x," ").concat(e.y):d+=" L ".concat(e.x," ").concat(e.y)}),(0,l.jsxs)("div",{className:"mt-6 mb-8",children:[(0,l.jsx)("h3",{className:"text-sm font-medium mb-4",children:"\xc9volution"}),(0,l.jsxs)("div",{className:"relative",style:{height:"".concat(200,"px")},children:[(0,l.jsxs)("svg",{width:"100%",height:200,className:"overflow-visible",children:[(0,l.jsxs)("text",{x:"0",y:40,className:"text-xs fill-neutral-500",children:[i.toFixed(1),"COMPLETION_RATE"===s.metricCode||"BUDGET_UTILIZATION"===s.metricCode||"TASK_COMPLETION"===s.metricCode?"%":""]}),(0,l.jsxs)("text",{x:"0",y:160,className:"text-xs fill-neutral-500",children:[a.toFixed(1),"COMPLETION_RATE"===s.metricCode||"BUDGET_UTILIZATION"===s.metricCode||"TASK_COMPLETION"===s.metricCode?"%":""]}),(0,l.jsx)("path",{d:d,fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-primary"}),c.map((e,t)=>(0,l.jsx)("g",{children:(0,l.jsx)("circle",{cx:e.x,cy:e.y,r:"4",className:"fill-primary"})},t))]}),(0,l.jsx)("div",{className:"flex justify-between mt-2",children:c.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-xs text-neutral-500",children:(0,h.p6)(new Date(c[0].date))}),c.length>2&&(0,l.jsx)("span",{className:"text-xs text-neutral-500",children:(0,h.p6)(new Date(c[Math.floor(c.length/2)].date))}),(0,l.jsx)("span",{className:"text-xs text-neutral-500",children:(0,h.p6)(new Date(c[c.length-1].date))})]})})]})]})})(),(0,l.jsx)("h3",{className:"text-sm font-medium mb-4",children:"Historique des mesures"}),(0,l.jsxs)(g.iA,{children:[(0,l.jsx)(g.xD,{children:(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.ss,{children:"Date"}),(0,l.jsx)(g.ss,{children:"Valeur"}),(0,l.jsx)(g.ss,{children:"Commentaire"})]})}),(0,l.jsx)(g.RM,{children:[...r].sort((e,t)=>new Date(t.measurementDate).getTime()-new Date(e.measurementDate).getTime()).map(e=>(0,l.jsxs)(g.SC,{children:[(0,l.jsx)(g.pj,{children:(0,h.o0)(new Date(e.measurementDate))}),(0,l.jsxs)(g.pj,{className:"font-medium",children:[e.value.toFixed(1),"COMPLETION_RATE"===e.metricCode||"BUDGET_UTILIZATION"===e.metricCode||"TASK_COMPLETION"===e.metricCode?"%":"","DEADLINE_PROXIMITY"===e.metricCode?" jours":""]}),(0,l.jsx)(g.pj,{children:e.comment||"-"})]},e.id||e.measurementDate))})]})]})]})]})}function ProjectDetailPage(){let[e,t]=(0,c.useState)(null),[s,a]=(0,c.useState)(!0),[r,i]=(0,c.useState)(null),[n,p]=(0,c.useState)("info"),[j,v]=(0,c.useState)(null),{id:g}=(0,d.useParams)(),f=(0,d.useRouter)();return(0,c.useEffect)(()=>{let fetchProject=async()=>{try{let e=await D.Hv.projects.getById(Number(g));t(e.data),i(null)}catch(e){console.error("Failed to fetch project:",e),i((0,h.e$)(e))}finally{a(!1)}};g&&fetchProject()},[g]),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)(x.z,{variant:"ghost",size:"sm",onClick:()=>f.push("/projects"),className:"flex items-center gap-1",children:[(0,l.jsx)(o.Z,{className:"h-4 w-4"}),"Retour"]}),(0,l.jsx)("h1",{className:"text-2xl font-bold",children:s?"Chargement...":(null==e?void 0:e.name)||"Projet introuvable"})]}),(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)(x.z,{variant:"outline",size:"sm",onClick:()=>{confirm("\xcates-vous s\xfbr de vouloir supprimer ce projet ? Cette action est irr\xe9versible.")&&f.push("/projects/".concat(g,"/delete"))},className:"flex items-center gap-1 text-error hover:bg-error/10",disabled:s||!e,children:[(0,l.jsx)(m,{className:"h-4 w-4"}),"Supprimer"]})})]}),r&&(0,l.jsxs)("div",{className:"bg-error/10 border border-error/30 rounded-md p-4 flex items-start gap-2 text-error",children:[(0,l.jsx)(u.Z,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"Erreur lors du chargement du projet"}),(0,l.jsx)("p",{className:"text-sm",children:r})]})]}),!r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Tabs,{tabs:[{id:"info",label:"Informations"},{id:"team",label:"\xc9quipe"},{id:"planning",label:"Planning"},{id:"actions",label:"Actions"},{id:"documents",label:"Documents"},{id:"budget",label:"Budget"},{id:"kpis",label:"KPIs"}],defaultTab:"info",onChange:p,className:"mb-6"}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(TabPanel,{id:"info",activeTab:n,children:(0,l.jsx)(ProjectInfo,{project:e,isLoading:s})}),(0,l.jsx)(TabPanel,{id:"team",activeTab:n,children:(0,l.jsx)(ProjectTeam,{project:e,isLoading:s})}),(0,l.jsx)(TabPanel,{id:"planning",activeTab:n,children:(0,l.jsx)(ProjectPlanning,{project:e,isLoading:s})}),(0,l.jsx)(TabPanel,{id:"actions",activeTab:n,children:(0,l.jsx)(ProjectActions,{project:e,isLoading:s})}),(0,l.jsx)(TabPanel,{id:"documents",activeTab:n,children:(0,l.jsx)(ProjectDocuments,{project:e,isLoading:s})}),(0,l.jsx)(TabPanel,{id:"budget",activeTab:n,children:(0,l.jsx)(ProjectBudget,{project:e,isLoading:s})}),(0,l.jsx)(TabPanel,{id:"kpis",activeTab:n,children:j&&e?(0,l.jsx)(KpiDetail,{project:e,kpiValue:j,onClose:()=>{v(null)}}):(0,l.jsx)(ProjectKpis,{project:e,onKpiSelect:e=>{v(e)}})})]})]})]})}},9496:function(e,t,s){"use strict";s.d(t,{E:function(){return l},_e:function(){return i},ai:function(){return r},sb:function(){return a},xn:function(){return n}});let a=[{title:"Total Projets",value:24,changePercent:12.5,bgColor:"bg-primary",textColor:"text-white"},{title:"En cours",value:15,changePercent:8.2,bgColor:"bg-info",textColor:"text-white"},{title:"Termin\xe9s",value:8,changePercent:24.3,bgColor:"bg-success",textColor:"text-white"},{title:"Budget Total",value:"â‚¬ 1.2M",changePercent:-3.5,bgColor:"bg-accent",textColor:"text-white"}],r=[{id:1,type:"task",title:"Mise \xe0 jour de la documentation API",status:"completed",date:new Date(2023,10,5,14,30),user:"Laurent Dupont",project:"Modernisation Syst\xe8me"},{id:2,type:"project",title:"Lancement projet Mobile Banking",status:"in_progress",date:new Date(2023,10,5,10,15),user:"Marie Leclerc"},{id:3,type:"document",title:"Cahier des charges v2.1",status:"updated",date:new Date(2023,10,4,16,45),user:"Thomas Bernard",project:"S\xe9curisation Donn\xe9es"},{id:4,type:"task",title:"Test d'int\xe9gration paiement",status:"delayed",date:new Date(2023,10,4,11,20),user:"Sophie Martin",project:"Mobile Banking"}],i=[{id:1,title:"Finaliser les sp\xe9cifications techniques",project:"Syst\xe8me CRM",priority:"high",dueDate:new Date(2023,10,10),status:"in_progress",progress:75},{id:2,title:"Int\xe9gration API paiement",project:"Mobile Banking",priority:"high",dueDate:new Date(2023,10,8),status:"pending",progress:20},{id:3,title:"R\xe9vision architecture de s\xe9curit\xe9",project:"S\xe9curisation Donn\xe9es",priority:"medium",dueDate:new Date(2023,10,15),status:"in_progress",progress:45},{id:4,title:"Tests de performance",project:"Modernisation Syst\xe8me",priority:"low",dueDate:new Date(2023,10,20),status:"pending",progress:0},{id:5,title:"Documentation utilisateur",project:"Syst\xe8me CRM",priority:"medium",dueDate:new Date(2023,10,12),status:"completed",progress:100}],n=[{name:"En cours",count:15,color:"#3b82f6"},{name:"Termin\xe9s",count:8,color:"#10b981"},{name:"Non d\xe9marr\xe9s",count:3,color:"#6b7280"},{name:"En retard",count:2,color:"#ef4444"}],l=[{month:"Jan",planned:5e4,actual:48e3},{month:"F\xe9v",planned:6e4,actual:65e3},{month:"Mar",planned:7e4,actual:68e3},{month:"Avr",planned:8e4,actual:75e3},{month:"Mai",planned:65e3,actual:6e4},{month:"Juin",planned:9e4,actual:1e5}]},9789:function(e,t,s){"use strict";s.d(t,{OS:function(){return getDataFromMockOrApi},zh:function(){return getMockKpiHistory},wA:function(){return getMockKpiValuesForProject}}),s(9496);let a=[{id:1,code:"COMPLETION_RATE",name:"Taux d'avancement",description:"Pourcentage d'avancement global du projet",unit:"%",thresholdWarning:50,thresholdCritical:25,higherIsBetter:!0,calculationFormula:"Calculate average progress of all actions",updateFrequencyMinutes:1440,enableNotifications:!0,createdAt:"2024-05-01T00:00:00Z",updatedAt:"2024-05-01T00:00:00Z",active:!0},{id:2,code:"BUDGET_UTILIZATION",name:"Utilisation du budget",description:"Pourcentage du budget consomm\xe9 par rapport au budget initial",unit:"%",thresholdWarning:85,thresholdCritical:95,higherIsBetter:!1,calculationFormula:"USED_BUDGET / TOTAL_BUDGET * 100",updateFrequencyMinutes:1440,enableNotifications:!0,createdAt:"2024-05-01T00:00:00Z",updatedAt:"2024-05-01T00:00:00Z",active:!0},{id:3,code:"TASK_COMPLETION",name:"T\xe2ches termin\xe9es",description:"Pourcentage de t\xe2ches termin\xe9es",unit:"%",thresholdWarning:40,thresholdCritical:20,higherIsBetter:!0,calculationFormula:"COMPLETED_TASKS / TOTAL_TASKS * 100",updateFrequencyMinutes:1440,enableNotifications:!0,createdAt:"2024-05-01T00:00:00Z",updatedAt:"2024-05-01T00:00:00Z",active:!0},{id:4,code:"DEADLINE_PROXIMITY",name:"Proximit\xe9 de l'\xe9ch\xe9ance",description:"Jours restants avant la date d'\xe9ch\xe9ance du projet",unit:"jours",thresholdWarning:10,thresholdCritical:5,higherIsBetter:!0,calculationFormula:"END_DATE - CURRENT_DATE",updateFrequencyMinutes:1440,enableNotifications:!0,createdAt:"2024-05-01T00:00:00Z",updatedAt:"2024-05-01T00:00:00Z",active:!0},{id:5,code:"RISK_INDEX",name:"Indice de risque",description:"Indice calcul\xe9 bas\xe9 sur les risques identifi\xe9s et leur criticit\xe9",unit:"indice",thresholdWarning:50,thresholdCritical:75,higherIsBetter:!1,calculationFormula:"SUM(RISK_PROBABILITY * RISK_IMPACT) / COUNT(RISKS)",updateFrequencyMinutes:1440,enableNotifications:!0,createdAt:"2024-05-01T00:00:00Z",updatedAt:"2024-05-01T00:00:00Z",active:!0}],getMockKpiValuesForProject=(e,t)=>[{id:1,metricId:1,metricCode:"COMPLETION_RATE",metricName:"Taux d'avancement",projectId:e,projectName:t,value:65.7,measurementDate:new Date().toISOString(),comment:"Calcul automatique",warningThresholdBreached:!1,criticalThresholdBreached:!1,notificationSent:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),active:!0},{id:2,metricId:2,metricCode:"BUDGET_UTILIZATION",metricName:"Utilisation du budget",projectId:e,projectName:t,value:78.3,measurementDate:new Date().toISOString(),comment:"Calcul automatique",warningThresholdBreached:!1,criticalThresholdBreached:!1,notificationSent:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),active:!0},{id:3,metricId:3,metricCode:"TASK_COMPLETION",metricName:"T\xe2ches termin\xe9es",projectId:e,projectName:t,value:58.2,measurementDate:new Date().toISOString(),comment:"Calcul automatique",warningThresholdBreached:!1,criticalThresholdBreached:!1,notificationSent:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),active:!0},{id:4,metricId:4,metricCode:"DEADLINE_PROXIMITY",metricName:"Proximit\xe9 de l'\xe9ch\xe9ance",projectId:e,projectName:t,value:15,measurementDate:new Date().toISOString(),comment:"Calcul automatique",warningThresholdBreached:!1,criticalThresholdBreached:!1,notificationSent:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),active:!0},{id:5,metricId:5,metricCode:"RISK_INDEX",metricName:"Indice de risque",projectId:e,projectName:t,value:35.5,measurementDate:new Date().toISOString(),comment:"Calcul automatique",warningThresholdBreached:!1,criticalThresholdBreached:!1,notificationSent:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),active:!0}],getMockKpiHistory=(e,t,s,r)=>{let i=new Date,n=[];for(let c=9;c>=0;c--){var l;let d=new Date(i);d.setDate(d.getDate()-c);let o=0;switch(t){case 1:o=30+4*c+5*Math.random();break;case 2:o=20+7*c+3*Math.random();break;case 3:o=25+4.5*c+4*Math.random();break;case 4:o=25-1*c;break;case 5:o=50-2*c+6*Math.random();break;default:o=50+10*Math.random()}o=Math.max(0,Math.min(100,o)),n.push({id:100+c,metricId:t,metricCode:(null===(l=a.find(e=>e.id===t))||void 0===l?void 0:l.code)||"",metricName:r,projectId:e,projectName:s,value:o,measurementDate:d.toISOString(),comment:"Mesure historique",warningThresholdBreached:!1,criticalThresholdBreached:!1,notificationSent:!1,createdAt:d.toISOString(),updatedAt:d.toISOString(),active:!0})}return n};var r=s(6454);async function getDataFromMockOrApi(e,t){if(r.dV.USE_MOCKS)return new Promise(t=>{setTimeout(()=>{t(e)},300)});let s=await t();return s.data}},3753:function(e,t,s){"use strict";var a=s(2265);function ArrowLeftIcon({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}let r=a.forwardRef(ArrowLeftIcon);t.Z=r},4291:function(e,t,s){"use strict";var a=s(2265);function ArrowPathIcon({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}let r=a.forwardRef(ArrowPathIcon);t.Z=r},2125:function(e,t,s){"use strict";var a=s(2265);function PencilIcon({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}let r=a.forwardRef(PencilIcon);t.Z=r}},function(e){e.O(0,[163,534,971,472,744],function(){return e(e.s=5757)}),_N_E=e.O()}]);