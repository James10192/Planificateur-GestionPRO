(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{803:function(e,t,r){"use strict";r.d(t,{Z:function(){return ProjectForm}});var a=r(7437),s=r(2265),n=r(4033),i=r(9310),o=r(6806),l=r(345);let c=s.forwardRef((e,t)=>{let{className:r,options:s,error:n,label:i,...o}=e;return(0,a.jsxs)("div",{className:"space-y-1",children:[i&&(0,a.jsx)("label",{htmlFor:o.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:i}),(0,a.jsxs)("select",{className:(0,l.cn)("w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n&&"border-error focus-visible:ring-error",r),ref:t,...o,children:[(0,a.jsx)("option",{value:"",children:"S\xe9lectionner..."}),s.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]})});c.displayName="Select";var d=r(6454);function ProjectForm(e){let{project:t,onSubmit:r,onError:u}=e,m=(0,n.useRouter)(),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(t||{name:"",description:"",typeId:0,statusId:0,priorityId:0,directionId:0,teamId:0,startDate:new Date().toISOString().split("T")[0],endDate:""}),[h,v]=(0,s.useState)([]),[b,y]=(0,s.useState)([]),[j,I]=(0,s.useState)([]),[N,w]=(0,s.useState)([]),[C,k]=(0,s.useState)([]),[D,S]=(0,s.useState)({});(0,s.useEffect)(()=>{!async function(){try{let[e,t,r,a,s]=await Promise.all([d.Hv.parameters.getProjectTypes(),d.Hv.parameters.getStatuses(),d.Hv.parameters.getPriorities(),d.Hv.parameters.getDirections(),d.Hv.teams.getAll()]);v(e.data),y(t.data),I(r.data),w(a.data),k(s.data)}catch(e){console.error("Error loading reference data:",e),u("Erreur lors du chargement des donn\xe9es de r\xe9f\xe9rence. Veuillez rafra\xeechir la page.")}}()},[u]);let handleInputChange=e=>{let{name:t,value:r}=e.target;x(e=>({...e,[t]:r})),D[t]&&S(e=>{let r={...e};return delete r[t],r})},validateForm=()=>{var e;let t={};return(null===(e=g.name)||void 0===e?void 0:e.trim())||(t.name="Le nom du projet est requis"),g.typeId||(t.typeId="Le type de projet est requis"),g.statusId||(t.statusId="Le statut est requis"),g.priorityId||(t.priorityId="La priorit\xe9 est requise"),g.directionId||(t.directionId="La direction est requise"),g.startDate||(t.startDate="La date de d\xe9but est requise"),S(t),0===Object.keys(t).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm()){f(!0);try{let e={...g,typeId:Number(g.typeId),statusId:Number(g.statusId),priorityId:Number(g.priorityId),directionId:Number(g.directionId),teamId:g.teamId&&Number(g.teamId)>0?Number(g.teamId):void 0};r(e)}catch(e){console.error("Error saving project:",e),u((0,l.e$)(e))}finally{f(!1)}}};return(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"name",className:"text-sm font-medium",children:["Nom du projet ",(0,a.jsx)("span",{className:"text-error",children:"*"})]}),(0,a.jsx)(i.I,{id:"name",name:"name",value:g.name,onChange:handleInputChange,error:!!D.name}),D.name&&(0,a.jsx)("p",{className:"text-sm text-error",children:D.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"typeId",className:"text-sm font-medium",children:["Type de projet ",(0,a.jsx)("span",{className:"text-error",children:"*"})]}),(0,a.jsx)(c,{id:"typeId",name:"typeId",value:g.typeId||"",onChange:handleInputChange,options:h.map(e=>({value:e.id,label:e.name})),error:!!D.typeId}),D.typeId&&(0,a.jsx)("p",{className:"text-sm text-error",children:D.typeId})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"statusId",className:"text-sm font-medium",children:["Statut ",(0,a.jsx)("span",{className:"text-error",children:"*"})]}),(0,a.jsx)(c,{id:"statusId",name:"statusId",value:g.statusId||"",onChange:handleInputChange,options:b.map(e=>({value:e.id,label:e.name})),error:!!D.statusId}),D.statusId&&(0,a.jsx)("p",{className:"text-sm text-error",children:D.statusId})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"priorityId",className:"text-sm font-medium",children:["Priorit\xe9 ",(0,a.jsx)("span",{className:"text-error",children:"*"})]}),(0,a.jsx)(c,{id:"priorityId",name:"priorityId",value:g.priorityId||"",onChange:handleInputChange,options:j.map(e=>({value:e.id,label:e.name})),error:!!D.priorityId}),D.priorityId&&(0,a.jsx)("p",{className:"text-sm text-error",children:D.priorityId})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"directionId",className:"text-sm font-medium",children:["Direction ",(0,a.jsx)("span",{className:"text-error",children:"*"})]}),(0,a.jsx)(c,{id:"directionId",name:"directionId",value:g.directionId||"",onChange:handleInputChange,options:N.map(e=>({value:e.id,label:"".concat(e.code," - ").concat(e.name)})),error:!!D.directionId}),D.directionId&&(0,a.jsx)("p",{className:"text-sm text-error",children:D.directionId})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"teamId",className:"text-sm font-medium",children:"\xc9quipe"}),(0,a.jsx)(c,{id:"teamId",name:"teamId",value:g.teamId||"",onChange:handleInputChange,options:C.map(e=>({value:e.id,label:e.name}))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"startDate",className:"text-sm font-medium",children:["Date de d\xe9but ",(0,a.jsx)("span",{className:"text-error",children:"*"})]}),(0,a.jsx)(i.I,{id:"startDate",name:"startDate",type:"date",value:g.startDate?g.startDate.split("T")[0]:"",onChange:handleInputChange,error:!!D.startDate}),D.startDate&&(0,a.jsx)("p",{className:"text-sm text-error",children:D.startDate})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"endDate",className:"text-sm font-medium",children:"Date de fin pr\xe9vue"}),(0,a.jsx)(i.I,{id:"endDate",name:"endDate",type:"date",value:g.endDate?g.endDate.split("T")[0]:"",onChange:handleInputChange})]})]}),(0,a.jsxs)("div",{className:"space-y-2 col-span-full",children:[(0,a.jsx)("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),(0,a.jsx)("textarea",{id:"description",name:"description",value:g.description||"",onChange:handleInputChange,rows:4,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(o.z,{type:"button",variant:"outline",onClick:()=>m.back(),children:"Annuler"}),(0,a.jsx)(o.z,{type:"submit",loading:p,children:(null==t?void 0:t.id)?"Mettre \xe0 jour":"Cr\xe9er"})]})]})}},6806:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var a=r(7437),s=r(2265),n=r(6061),i=r(345);let o=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-white hover:bg-primary/90",destructive:"bg-error text-white hover:bg-error/90",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-white hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-white hover:bg-success/90",warning:"bg-warning text-white hover:bg-warning/90"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-12 rounded-md px-6",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=(0,s.forwardRef)((e,t)=>{let{className:r,variant:s,size:n,loading:l=!1,children:c,disabled:d,...u}=e;return(0,a.jsxs)("button",{className:(0,i.cn)(o({variant:s,size:n,className:r})),ref:t,disabled:d||l,...u,children:[l&&(0,a.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]})});l.displayName="Button"},1018:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return l}});var a=r(7437),s=r(2265),n=r(345);let i=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});i.displayName="Card";let o=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});o.displayName="CardHeader";let l=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let c=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},9310:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var a=r(7437),s=r(2265),n=r(345);let i=s.forwardRef((e,t)=>{let{className:r,type:s,error:i,icon:o,...l}=e;return(0,a.jsxs)("div",{className:"relative",children:[o&&(0,a.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:o}),(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i&&"border-error focus-visible:ring-error",o&&"pl-10",r),ref:t,...l})]})});i.displayName="Input"},6454:function(e,t,r){"use strict";r.d(t,{Hv:function(){return l},dV:function(){return c}});var a=r(4829),s=r(2601);let n="true"===s.env.NEXT_PUBLIC_USE_MOCKS,i=s.env.NEXT_PUBLIC_API_BASE_URL||"/api/v1",o=a.Z.create({baseURL:i,headers:{"Content-Type":"application/json"}});o.interceptors.response.use(e=>e,e=>{var t;return console.error("API Error:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message),Promise.reject(e)});let l={projects:{getAll:()=>o.get("/projects"),getById:e=>o.get("/projects/".concat(e)),create:e=>o.post("/projects",e),update:(e,t)=>o.put("/projects/".concat(e),t),delete:e=>o.delete("/projects/".concat(e)),getActions:e=>o.get("/projects/".concat(e,"/actions"))},actions:{getAll:()=>o.get("/actions"),getById:e=>o.get("/actions/".concat(e)),create:e=>o.post("/actions",e),update:(e,t)=>o.put("/actions/".concat(e),t),delete:e=>o.delete("/actions/".concat(e)),getSubActions:e=>o.get("/actions/".concat(e,"/sub-actions"))},plannings:{getAll:()=>o.get("/plannings"),getById:e=>o.get("/plannings/".concat(e)),create:e=>o.post("/plannings",e),update:(e,t)=>o.put("/plannings/".concat(e),t),delete:e=>o.delete("/plannings/".concat(e))},parameters:{getProjectTypes:()=>o.get("/parameters/project-types"),getStatuses:()=>o.get("/parameters/statuses"),getPriorities:()=>o.get("/parameters/priorities"),getDirections:()=>o.get("/parameters/directions"),getPortfolioPhases:()=>o.get("/parameters/portfolio-phases"),getTeamRoles:()=>o.get("/parameters/team-roles")},users:{getAll:()=>o.get("/users"),getById:e=>o.get("/users/".concat(e)),create:e=>o.post("/users",e),update:(e,t)=>o.put("/users/".concat(e),t),delete:e=>o.delete("/users/".concat(e))},teams:{getAll:()=>o.get("/teams"),getById:e=>o.get("/teams/".concat(e)),create:e=>o.post("/teams",e),update:(e,t)=>o.put("/teams/".concat(e),t),delete:e=>o.delete("/teams/".concat(e)),getMembers:e=>o.get("/teams/".concat(e,"/members"))},dashboard:{getSummary:()=>o.get("/dashboard/summary"),getRecentActivities:()=>o.get("/dashboard/activities"),getTasksByUser:e=>o.get("/dashboard/tasks/user/".concat(e))},kpis:{getMetrics:()=>o.get("/kpis/metrics"),getMetricById:e=>o.get("/kpis/metrics/".concat(e)),createMetric:e=>o.post("/kpis/metrics",e),updateMetric:(e,t)=>o.put("/kpis/metrics/".concat(e),t),deleteMetric:e=>o.delete("/kpis/metrics/".concat(e)),getProjectKpis:e=>o.get("/kpis/projects/".concat(e)),getProjectKpiHistory:(e,t)=>o.get("/kpis/projects/".concat(e,"/metrics/").concat(t,"/history")),recordKpiValue:(e,t,r)=>o.post("/kpis/projects/".concat(e,"/metrics/").concat(t),r),calculateKpi:(e,t)=>o.post("/kpis/projects/".concat(e,"/metrics/").concat(t,"/calculate")),exportKpiData:(e,t)=>o.get("/kpis/projects/".concat(e,"/export?format=").concat(t),{responseType:"blob"})}},c={USE_MOCKS:n,API_BASE_URL:i};console.log("[API Config] Using mocks:",n)},345:function(e,t,r){"use strict";r.d(t,{Qm:function(){return getInitials},T3:function(){return formatPercent},cn:function(){return cn},e$:function(){return getErrorMessage},o0:function(){return formatDateTime},p6:function(){return formatDate},xG:function(){return formatCurrency}});var a=r(7042),s=r(3986),n=r(7124),i=r(4493),o=r(8694);function cn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m)((0,a.W)(t))}function formatDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PPP";if(!e)return"-";try{let r="string"==typeof e?(0,i.Z)(e):e;return(0,n.Z)(r,t,{locale:o.Z})}catch(t){return console.error("Date formatting error:",t),"string"==typeof e?e:e.toString()}}function formatDateTime(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PPP \xe0 HH:mm";return formatDate(e,t)}function formatPercent(e){return null==e?"-":"".concat(Math.round(e),"%")}function formatCurrency(e){return null==e?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(e)}function getInitials(e,t){if(!e&&!t)return"?";let r=e?e.charAt(0).toUpperCase():"",a=t?t.charAt(0).toUpperCase():"";return"".concat(r).concat(a)}function getErrorMessage(e){let t="Une erreur s'est produite. Veuillez r\xe9essayer.";if(!e||!e.response)return t;let{status:r}=e.response;switch(r){case 400:return"Donn\xe9es invalides. Veuillez v\xe9rifier vos informations.";case 401:return"Non autoris\xe9. Veuillez vous connecter.";case 403:return"Vous n'avez pas les droits pour effectuer cette action.";case 404:return"Ressource non trouv\xe9e.";case 409:return"Conflit avec l'\xe9tat actuel de la ressource.";case 500:return"Erreur serveur. Veuillez r\xe9essayer ult\xe9rieurement.";default:return t}}},4033:function(e,t,r){e.exports=r(94)},3753:function(e,t,r){"use strict";var a=r(2265);function ArrowLeftIcon({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}let s=a.forwardRef(ArrowLeftIcon);t.Z=s},5838:function(e,t,r){"use strict";var a=r(2265);function ExclamationCircleIcon({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}let s=a.forwardRef(ExclamationCircleIcon);t.Z=s},6061:function(e,t,r){"use strict";r.d(t,{j:function(){return cva}});var a=r(7042);let falsyToString=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=a.W,cva=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(e=>{let t=null==r?void 0:r[e],a=null==i?void 0:i[e];if(null===t)return null;let s=falsyToString(t)||falsyToString(a);return n[e][s]}),l=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{}),c=null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:r,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...l}[t]):({...i,...l})[t]===r})?[...e,r,a]:e},[]);return s(e,o,c,null==r?void 0:r.class,null==r?void 0:r.className)}}}]);